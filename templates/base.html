<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}××•×–×™×§×” ×œ×›×•×œ×{% endblock %}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    {% block head %}{% endblock %}
    <script src="{{ url_for('static', filename='js/script.js') }}" defer></script>
    <script src="{{ url_for('static', filename='js/auto_logout.js') }}" defer></script>
</head>
<body>

    <!-- ×ª×¤×¨×™×˜ × ×™×•×•×˜ - ×¨×§ ××™×™×§×•×Ÿ -->
    <nav class="modern-navbar">
        <div class="navbar-container">
            <!-- ××™×™×§×•×Ÿ ×ª×¤×¨×™×˜ + ×ª××•× ×ª ×¤×¨×•×¤×™×œ (×œ×—×™×¦×” ×¢×œ ×”×ª××•× ×” â†’ ×¤×¨×•×¤×™×œ) -->
            <div class="navbar-toggle">
                {% if session.get('user_id') %}
                    <div class="menu-trigger" onclick="toggleMenu()" title="×ª×¤×¨×™×˜">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    {% set profile_image = session.get('profile_image', '') %}
                    {% if profile_image %}
                        <a href="{{ url_for('students.user_profile') }}" class="profile-menu-trigger" title="×”×¤×¨×•×¤×™×œ ×©×œ×™">
                            <img src="{{ profile_image }}" alt="×ª××•× ×ª ×¤×¨×•×¤×™×œ" class="navbar-profile-img">
                            <div class="status-indicator"></div>
                        </a>
                    {% endif %}
                {% else %}
                    <div class="menu-trigger" onclick="toggleMenu()">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- ×ª×¤×¨×™×˜ × ×¤×ª×— -->
        <div class="navbar-menu" id="navbar-menu">
            <div class="menu-overlay" onclick="toggleMenu()"></div>
            <div class="menu-content">
                <!-- ×›×•×ª×¨×ª ×ª×¤×¨×™×˜ -->
                <div class="menu-header">
                    {% if session.get('user_id') %}
                        {% set role_names = {'admin': '××“××™×Ÿ', 'teacher': '××•×¨×”', 'musician': '××•×¡×™×§××™', 'student': '×ª×œ××™×“'} %}
                        {% set roles = session.get('roles', []) %}
                        {% set ns = namespace(labels=[]) %}
                        {% for r in ['admin', 'teacher', 'musician', 'student'] %}
                            {% if r in roles %}{% set _ = ns.labels.append(role_names[r]) %}{% endif %}
                        {% endfor %}
                        <a href="{{ url_for('students.user_profile') }}" class="user-info-link" onclick="document.getElementById('navbar-menu').classList.remove('active'); document.body.style.overflow='auto';">
                            <div class="user-info">
                                {% set profile_image = session.get('profile_image', '') %}
                                {% if profile_image %}
                                    <img src="{{ profile_image }}" alt="×ª××•× ×ª ×¤×¨×•×¤×™×œ" class="menu-profile-img">
                                {% else %}
                                    <div class="menu-avatar-placeholder">
                                        <i class="fas fa-user"></i>
                                    </div>
                                {% endif %}
                                <div class="user-details">
                                    <h3>{{ session.get('username') }}</h3>
                                    <p>×”×¤×¨×•×¤×™×œ ×©×œ×™</p>
                                    {% if ns.labels %}
                                        <p class="user-roles">{{ ns.labels | join(' â€¢ ') }}</p>
                                    {% endif %}
                                </div>
                            </div>
                        </a>
                    {% else %}
                        <div class="guest-info">
                            <h3>ğŸµ ××•×–×™×§×” ×œ×›×•×œ×</h3>
                            <p>×‘×¨×•×›×™× ×”×‘××™×</p>
                        </div>
                    {% endif %}
                </div>

                <!-- ×§×™×©×•×¨×™ ×ª×¤×¨×™×˜ -->
                <ul class="menu-links">
                    {% set roles = session.get('roles', []) %}
                    {% if session.get('user_id') %}
                        <li class="menu-item">
                            <a href="{{ url_for('home') }}" class="menu-link">
                                <i class="fas fa-home"></i>
                                <span>×“×£ ×”×‘×™×ª</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('students.user_profile') }}" class="menu-link">
                                <i class="fas fa-user-circle"></i>
                                <span>×”×¤×¨×•×¤×™×œ ×©×œ×™</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('songs.songs') }}" class="menu-link">
                                <i class="fas fa-music"></i>
                                <span>×©×™×¨×™×</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('my_songs.my_songs_page') }}" class="menu-link">
                                <i class="fas fa-heart"></i>
                                <span>×”×©×™×¨×™× ×©×œ×™</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('teachers.list_teachers') }}" class="menu-link">
                                <i class="fas fa-chalkboard-teacher"></i>
                                <span>××•×¨×™×</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('tutorials.tutorials') }}" class="menu-link">
                                <i class="fas fa-book"></i>
                                <span>×©×™×¢×•×¨×™× ×‘×•×“×“×™×</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('courses.courses_list') }}" class="menu-link">
                                <i class="fas fa-graduation-cap"></i>
                                <span>×§×•×¨×¡×™×</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('products.products_page') }}" class="menu-link">
                                <i class="fas fa-shopping-cart"></i>
                                <span>××•×¦×¨×™× ×œ××•×¡×™×§××™×</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('general.contact_page') }}" class="menu-link">
                                <i class="fas fa-envelope"></i>
                                <span>×™×¦×™×¨×ª ×§×©×¨</span>
                            </a>
                        </li>
                        <li class="menu-item logout">
                            <a href="{{ url_for('auth.logout') }}" class="menu-link">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>×”×ª× ×ª×§</span>
                            </a>
                        </li>
                    {% else %}
                        <li class="menu-item">
                            <a href="{{ url_for('home') }}" class="menu-link">
                                <i class="fas fa-home"></i>
                                <span>×“×£ ×”×‘×™×ª</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('songs.songs') }}" class="menu-link">
                                <i class="fas fa-music"></i>
                                <span>×©×™×¨×™×</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('auth.login') }}" class="menu-link" title="×”×ª×—×‘×¨ ×›×“×™ ×œ×’×©×ª ×œ×¨×©×™××ª ×”×©×™×¨×™× ×©×œ×š">
                                <i class="fas fa-heart"></i>
                                <span>×”×©×™×¨×™× ×©×œ×™</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('teachers.list_teachers') }}" class="menu-link">
                                <i class="fas fa-chalkboard-teacher"></i>
                                <span>××•×¨×™×</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('tutorials.tutorials') }}" class="menu-link">
                                <i class="fas fa-book"></i>
                                <span>×©×™×¢×•×¨×™× ×‘×•×“×“×™×</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('courses.courses_list') }}" class="menu-link">
                                <i class="fas fa-graduation-cap"></i>
                                <span>×§×•×¨×¡×™×</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('products.products_page') }}" class="menu-link">
                                <i class="fas fa-shopping-cart"></i>
                                <span>××•×¦×¨×™× ×œ××•×¡×™×§××™×</span>
                            </a>
                        </li>
                        <li class="menu-item">
                            <a href="{{ url_for('general.contact_page') }}" class="menu-link">
                                <i class="fas fa-envelope"></i>
                                <span>×™×¦×™×¨×ª ×§×©×¨</span>
                            </a>
                        </li>
                        <li class="menu-item special">
                            <a href="{{ url_for('auth.login') }}" class="menu-link">
                                <i class="fas fa-sign-in-alt"></i>
                                <span>×”×ª×—×‘×¨</span>
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <div class="content">
        {% block content %}{% endblock %}
    </div>

    {% block scripts %}{% endblock %}
</body>
</html>
